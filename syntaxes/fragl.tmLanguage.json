{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "FRAGL",
	"scopeName": "source.fragl",
	"patterns": [
		{
			"include": "#comment"
		},
		{
			"include": "#tag-interior"
		},
		{
			"include": "#tag"
		},
		{
			"include": "#reference"
		}
	],
	"repository": {
		"param-then-attributes": {
			"patterns": [
				{
					"include": "#parameter-list"
				},
				{
					"include": "#attribute"
				}
			]
		},
		"class-instantiation": {
			"patterns": [
				{
					"begin": "(?<!<)(::)([a-zA-Z][.0-9_a-zA-Z]*)\\s*(\\()",
					"beginCaptures": {
						"1": { "name": "keyword.operator.constructor.fragl" },
						"2": { "name": "entity.name.class.fragl" },
						"3": { "name": "punctuation.definition.class.parameter-list.begin.fragl"}
					},
					"end": "\\)",
					"endCaptures": {
						"0": { "name": "punctuation.definition.class.parameter-list.end.fragl" }
					},
					"name": "meta.class-instantiation.fragl",
					"patterns": [
						{
							"include": "#argument"
						}
					]
				}
			]
		},
		"attribute": {
			"patterns": [
				{
					"include": "#class-instantiation"
				},
				{
					"match": "(?<!<)(::)([a-zA-Z][.0-9_a-zA-Z]*)\\s*(?!\\()",
					"captures": {
						"1": { "name": "keyword.operator.constructor.fragl" },
						"2": { "name": "entity.name.class.fragl" }
					},
					"name": "meta.tag.class.opening.fragl"
				},
				{
					"begin": "([^\\x{0020}\"'<>/=\\x{0000}-\\x{001F}\\x{007F}-\\x{009F}\\x{FDD0}-\\x{FDEF}\\x{FFFE}\\x{FFFF}\\x{1FFFE}\\x{1FFFF}\\x{2FFFE}\\x{2FFFF}\\x{3FFFE}\\x{3FFFF}\\x{4FFFE}\\x{4FFFF}\\x{5FFFE}\\x{5FFFF}\\x{6FFFE}\\x{6FFFF}\\x{7FFFE}\\x{7FFFF}\\x{8FFFE}\\x{8FFFF}\\x{9FFFE}\\x{9FFFF}\\x{AFFFE}\\x{AFFFF}\\x{BFFFE}\\x{BFFFF}\\x{CFFFE}\\x{CFFFF}\\x{DFFFE}\\x{DFFFF}\\x{EFFFE}\\x{EFFFF}\\x{FFFFE}\\x{FFFFF}\\x{10FFFE}\\x{10FFFF}]+)",
					"beginCaptures": {
						"0": {
							"name": "entity.other.attribute-name.fragl"
						}
					},
					"comment": "Unicode key-value attributes",
					"end": "(?=\\s*+[^=\\s])",
					"name": "meta.attribute.$1.fragl",
					"patterns": [
						{
							"include": "#attribute-interior"
						}
					]
				},
				{
					"match": "[^\\s>]+",
					"name": "invalid.illegal.character-not-allowed-here.fragl"
				}
			]
		},
		"attribute-interior": {
			"patterns": [
				{
					"begin": "=",
					"beginCaptures": {
						"0": {
							"name": "punctuation.separator.key-value.fragl"
						}
					},
					"end": "(?<=[^\\s=])(?!\\s*=)|(?=/?>)",
					"patterns": [
						{
							"match": "([^\\s\"'=<>`/]|/(?!>))+",
							"name": "string.unquoted.fragl"
						},
						{
							"begin": "\"",
							"beginCaptures": {
								"0": {
									"name": "punctuation.definition.string.begin.fragl"
								}
							},
							"end": "\"",
							"endCaptures": {
								"0": {
									"name": "punctuation.definition.string.end.fragl"
								}
							},
							"name": "string.quoted.double.fragl",
							"patterns": []
						},
						{
							"begin": "'",
							"beginCaptures": {
								"0": {
									"name": "punctuation.definition.string.begin.fragl"
								}
							},
							"end": "'",
							"endCaptures": {
								"0": {
									"name": "punctuation.definition.string.end.fragl"
								}
							},
							"name": "string.quoted.single.fragl",
							"patterns": []
						},
						{
							"match": "=",
							"name": "invalid.illegal.unexpected-equals-sign.fragl"
						}
					]
				}
			]
		},
		"string": {
			"name": "string.quoted.double.fragl",
			"begin": "\"",
			"end": "\"",
			"patterns": [
				{
					"name": "constant.character.escape.fragl",
					"match": "\\\\."
				}
			]
		},
		"comment": {
			"begin": "<!--",
			"captures": {
				"0": {
					"name": "punctuation.definition.comment.fragl"
				}
			},
			"end": "-->",
			"name": "comment.block.fragl",
			"patterns": [
				{
					"match": "\\G-?>",
					"name": "invalid.illegal.characters-not-allowed-here.fragl"
				},
				{
					"match": "<!--(?!>)|<!-(?=-->)",
					"name": "invalid.illegal.characters-not-allowed-here.fragl"
				},
				{
					"match": "--!>",
					"name": "invalid.illegal.characters-not-allowed-here.fragl"
				}
			]
		},
		"argument": {
			"patterns": [
				{
					"include": "#class-instantiation"
				},
				{
					"begin": "(@)?(\\[)",
					"beginCaptures": {
						"1": { "name": "keyword.control.loop.list-prefix.fragl" },
						"2": { "name": "punctuation.definition.list-literal.begin.fragl" }
					},
					"end": "\\]",
					"endCaptures": {
						"0": { "name": "punctuation.definition.list-literal.end.fragl" }
					},
					"name": "meta.list-literal.fragl",
					"patterns": [
						{
							"include": "#argument"
						}
					]
				},
				{
					"begin": "(?<=\\])\\s*(?={)",
					"end": "=>",
					"endCaptures": {
						"0": { "name": "keyword.control.function.loop.fragl" }
					},
					"name": "meta.list-literal.loop.fragl",
					"patterns": [
						{
							"include": "#parameter-list"
						}
					]
				},
				{
					"include": "#string"
				},
				{
					"begin": "([a-zA-Z][0-9_a-zA-Z]*)\\s*(\\()",
					"beginCaptures": {
						"1": { "name": "entity.name.function.fragl" },
						"2": { "name": "punctuation.definition.function.argument-list.begin.fragl" }
					},
					"end": "\\)",
					"endCaptures": {
						"0": { "name": "punctuation.definition.function.argument-list.end.fragl" }
					},
					"name": "meta.function-invocation.fragl",
					"patterns": [
						{
							"include": "#argument"
						}
					]
				},
				{
					"match": "\\b[a-zA-Z][0-9_a-zA-Z]*\\b",
					"name": "variable.name.fragl"
				}
			]
		},
		"parameter-list": {
			"begin": "{",
			"end": "}",
			"name": "meta.parameter-list.fragl",
			"patterns": [
				{
					"match": "\\b[a-zA-Z][.0-9_a-zA-Z]*\\b",
					"name": "variable.parameter.fragl"
				}
			]
		},
		"reference": {
			"patterns": [
				{
					"match": "(#)([a-zA-Z][.0-9_a-zA-Z]*)",
					"captures": {
						"1": { "name": "keyword.operator.reference.fragl" },
						"2": { "name": "variable.name.reference.fragl" }
					}
				}
			]
		},
		"tag-interior": {
			"patterns": [
				{
					"begin": "<(?=::[a-zA-Z])",
					"beginCaptures": {
						"0": { "name": "punctuation.definition.tag.opening.begin.fragl" }
					},
					"end": "(</)([a-zA-Z][.0-9_a-zA-Z]*)(>)",
					"endCaptures": {
						"1": { "name": "punctuation.definition.tag.closing.begin.fragl" },
						"2": { "name": "entity.name.class.fragl" },
						"3": { "name": "punctuation.definition.tag.closing.end.fragl" }
					},
					"name": "meta.tag.class.interior.fragl",
					"patterns": [
						{ "include": "$self" }
					]
				},
				{
					"begin": "<(?=@[a-zA-Z][.0-9_a-zA-Z]*\\s*{)",
					"beginCaptures": {
						"0": { "name": "punctuation.definition.tag.opening.begin.fragl" }
					},
					"end": "(</)([a-zA-Z][.0-9_a-zA-Z]*)?(>)",
					"endCaptures": {
						"1": { "name": "punctuation.definition.tag.closing.begin.fragl" },
						"2": { "name": "entity.name.section.loop.fragl" },
						"3": { "name": "punctuation.definition.tag.closing.end.fragl" }
					},
					"name": "meta.tag.loop.interior.fragl",
					"patterns": [
						{ "include": "$self" }
					]
				},
				{
					"begin": "<(?=@\\s*\\()",
					"beginCaptures": {
						"0": { "name": "punctuation.definition.tag.loop.opening.begin.fragl" }
					},
					"end": "</>",
					"endCaptures": {
						"0": { "name": "punctuation.definition.tag.loop.closing.fragl" }
					},
					"name": "meta.tag.loop.interior.fragl",
					"patterns": [
						{ "include": "$self" }
					]
				},
				{
					"begin": "<(?=\\?\\s*(?:[a-zA-Z][.0-9_a-zA-Z]*\\(?|\\())",
					"beginCaptures": {
						"0": { "name": "punctuation.definition.tag.cond.opening.begin.fragl" }
					},
					"end": "</>",
					"endCaptures": {
						"0": { "name": "punctuation.definition.tag.cond.closing.fragl" }
					},
					"name": "meta.tag.cond.interior.fragl",
					"patterns": [
						{
							"match": "(<)(:)(>)",
							"captures": {
								"1": { "name": "punctuation.definition.tag.cond.else.begin.fragl" },
								"2": { "name": "keyword.control.cond.else.fragl" },
								"3": { "name": "punctuation.definition.tag.cond.else.endfragl" }
							}
						},
						{ "include": "$self" }
					]
				},
				{
					"begin": "<(?=[a-zA-Z][.0-9_a-zA-Z]*\\s*{)",
					"beginCaptures": {
						"0": { "name": "punctuation.definition.tag.opening.begin.fragl" }
					},
					"end": "(</)([a-zA-Z][.0-9_a-zA-Z]*)(>)",
					"endCaptures": {
						"1": { "name": "punctuation.definition.tag.closing.begin.fragl" },
						"2": { "name": "entity.name.function.fragl" },
						"3": { "name": "punctuation.definition.tag.closing.end.fragl" }
					},
					"name": "meta.tag.function.interior.fragl",
					"patterns": [
						{ "include": "$self" }
					]
				},
				{
					"begin": "<(?=[a-zA-Z].*[^/]>)",
					"beginCaptures": {
						"0": { "name": "punctuation.definition.tag.opening.begin.fragl" }
					},
					"end": "(</)([a-zA-Z][.0-9_a-zA-Z]*)(>)",
					"endCaptures": {
						"1": { "name": "punctuation.definition.tag.closing.begin.fragl" },
						"2": { "name": "entity.name.tag.object.fragl" },
						"3": { "name": "punctuation.definition.tag.closing.end.fragl" }
					},
					"name": "meta.tag.object.interior.fragl",
					"patterns": [
						{ "include": "$self" }
					]
				}
			]
		},
		"tag": {
			"patterns": [
				{
					"begin": "(?<=<)(::)([a-zA-Z][.0-9_a-zA-Z]*)(?=\\s*{)",
					"beginCaptures": {
						"1": { "name": "keyword.operator.constructor.fragl" },
						"2": { "name": "entity.name.class.fragl" }
					},
					"end": ">",
					"endCaptures": {
						"0": { "name": "punctuation.definition.tag.opening.end.fragl" }
					},
					"name": "meta.tag.class.opening.fragl",
					"patterns": [
						{ "include": "#param-then-attributes" }
					]
				},
				{
					"begin": "(?<=<)(@)([a-zA-Z][.0-9_a-zA-Z]*)(?=\\s*{)",
					"beginCaptures": {
						"1": { "name": "keyword.control.loop.fragl" },
						"2": { "name": "entity.name.section.loop.fragl" }
					},
					"end": ">",
					"endCaptures": {
						"0": { "name": "punctuation.definition.tag.opening.end.fragl" }
					},
					"name": "meta.tag.loop.for-in.fragl",
					"patterns": [
						{ "include": "#param-then-attributes" }
					]
				},
				{
					"begin": "(?<=<)(\\?)([a-zA-Z][.0-9_a-zA-Z]*)",
					"beginCaptures": {
						"1": { "name": "keyword.control.loop.fragl" },
						"2": { "name": "entity.name.section.loop.fragl" }
					},
					"end": ">",
					"endCaptures": {
						"0": { "name": "punctuation.definition.tag.opening.end.fragl" }
					},
					"name": "meta.tag.cond.variable.fragl",
					"patterns": [
						{ "include": "#param-then-attributes" }
					]
				},
				{
					"begin": "(?<=<)(@)\\s*(\\()",
					"beginCaptures": {
						"1": { "name": "keyword.control.loop.fragl" },
						"2": { "name": "punctuation.definition.loop.argument-list.begin.fragl" }
					},
					"end": "\\)>",
					"endCaptures": {
						"0": { "name": "punctuation.definition.loop.argument-list.end.fragl" }
					},
					"name": "meta.tag.loop.while.fragl",
					"patterns": [
						{ "include": "#argument" }
					]
				},
				{
					"begin": "(?<=<)(\\?)\\s*([a-zA-Z][.0-9_a-zA-Z]*)?(\\()",
					"beginCaptures": {
						"1": { "name": "keyword.control.cond.fragl" },
						"2": { "name": "entity.name.variable.fragl" },
						"3": { "name": "punctuation.definition.cond.argument-list.begin.fragl" }
					},
					"end": "\\)>",
					"endCaptures": {
						"0": { "name": "punctuation.definition.cond.argument-list.end.fragl" }
					},
					"name": "meta.tag.cond.expression.fragl",
					"patterns": [
						{ "include": "#argument" }
					]
				},
				{
					"begin": "(?<=<)([a-zA-Z][.0-9_a-zA-Z]*)(?=\\s*{)",
					"beginCaptures": {
						"1": { "name": "entity.name.function.fragl" }
					},
					"end": ">",
					"endCaptures": {
						"0": { "name": "punctuation.definition.tag.opening.end.fragl" }
					},
					"name": "meta.tag.function.opening.fragl",
					"patterns": [
						{ "include": "#param-then-attributes" }
					]
				},
				{
					"begin": "(?<=<)([a-zA-Z][.0-9_a-zA-Z]*)(?!.*/>)",
					"beginCaptures": {
						"1": { "name": "entity.name.tag.object.fragl" }
					},
					"end": ">",
					"endCaptures": {
						"0": { "name": "punctuation.definition.tag.opening.end.fragl" }
					},
					"name": "meta.tag.object.opening.fragl",
					"patterns": [
						{ "include": "#attribute" }
					]
				},
				{
					"begin": "</?",
					"beginCaptures": {
						"0": { "name": "punctuation.definition.tag.begin.fragl" }
					},
					"end": "/>",
					"endCaptures": {
						"0": { "name": "punctuation.definition.tag.end.fragl" }
					},
					"name": "meta.tag.expression.fragl",
					"patterns": [
						{ "include": "#argument" }
					]
				}
			]
		}
	}
}